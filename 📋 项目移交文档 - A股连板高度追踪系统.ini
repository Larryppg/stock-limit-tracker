ğŸ“‹ é¡¹ç›®ç§»äº¤æ–‡æ¡£ - Aè‚¡è¿æ¿é«˜åº¦è¿½è¸ªç³»ç»Ÿ
ä¸€ã€æ ¸å¿ƒéœ€æ±‚æ¦‚è¿°
å¼€å‘ä¸€ä¸ªAè‚¡è¿æ¿ï¼ˆæ¶¨åœæ¿ï¼‰é«˜åº¦è¿½è¸ªç³»ç»Ÿï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼š

1.1 æ ¸å¿ƒæŒ‡æ ‡
è¿æ¿é«˜åº¦è®¡ç®—ï¼šè¿½è¸ªæ¯åªè‚¡ç¥¨çš„è¿ç»­æ¶¨åœå¤©æ•°ï¼ˆ1æ¿/2æ¿/.../Næ¿ï¼‰
è¿æ¿é“¾è¯†åˆ«ï¼šåŒºåˆ†ä¸€å­—æ¿ã€æ¢¯å½¢æ¿ã€å®ä½“æ¿
ç‚¸æ¿æ£€æµ‹ï¼šè¯†åˆ«å½“æ—¥å…ˆæ¶¨åœåæ‰“å¼€çš„è‚¡ç¥¨
è¿æ¿æ–­é“¾åˆ¤å®šï¼šå½“è‚¡ç¥¨ä¸å†æ¶¨åœæ—¶ï¼Œè¿æ¿é“¾æ¡å½’é›¶
1.2 ä¸šåŠ¡åœºæ™¯
è¿½è¸ª2020å¹´è‡³ä»Šçš„å…¨éƒ¨Aè‚¡è¿æ¿æ•°æ®
æ”¯æŒå®æ—¶æ›´æ–°ï¼ˆæ¯æ—¥æ”¶ç›˜åï¼‰
æä¾›æ•°æ®æŸ¥è¯¢æ¥å£ï¼ˆå¦‚ï¼šæŸ¥è¯¢æŸæ—¥æ‰€æœ‰2æ¿ä»¥ä¸Šçš„è‚¡ç¥¨ï¼‰
äºŒã€å·²ç¡®å®šçš„æŠ€æœ¯æ–¹æ¡ˆ
2.1 æ•°æ®æº
ä¸»åŠ›ï¼šAkShareï¼ˆå…è´¹ç¨³å®šï¼ŒPythonåº“ï¼‰
å¤‡ç”¨ï¼šTushareï¼ˆéœ€Tokenï¼‰
å®æ—¶æ•°æ®ï¼šé•¿æ±Ÿè´¢å¯Œé€šåŒèŠ±é¡ºæ¥å£
2.2 æŠ€æœ¯æ ˆ
åç«¯ï¼šPython 3.9+
æ•°æ®åº“ï¼šSQLiteï¼ˆå•æœºï¼‰/ PostgreSQLï¼ˆå¤šç”¨æˆ·ï¼‰
æ•°æ®è·å–ï¼šAkShare + Pandas
ä»»åŠ¡è°ƒåº¦ï¼šAPSchedulerï¼ˆå®šæ—¶å¢é‡æ›´æ–°ï¼‰
å¯è§†åŒ–ï¼šå¯é€‰ï¼ˆStreamlit/FastAPI + Vueï¼‰
â€‹
2.3 æ•°æ®åº“æ ¸å¿ƒè¡¨ç»“æ„
-- è‚¡ç¥¨å…ƒä¿¡æ¯è¡¨
stock_meta (code, name, market, board_type, limit_ratio, is_st)

-- æ—¥çº¿è¡Œæƒ…è¡¨
daily_market_data (date, code, open, high, low, close, pre_close, volume, amount)

-- æ¶¨åœåˆ†æç»“æœè¡¨
limit_analysis_result (date, code, limit_status, chain_height, is_fried, board_type)

-- æ•°æ®è·å–è¿›åº¦è¡¨ï¼ˆæ–­ç‚¹ç»­ä¼ ï¼‰
fetch_progress (task_id, start_date, end_date, current_date, status)
â€‹
ä¸‰ã€æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼ˆå¾…å®ç°ï¼‰
3.1 æ¶¨åœåˆ¤å®šè§„åˆ™
# ä¸»æ¿/åˆ›ä¸šæ¿/ç§‘åˆ›æ¿æ¶¨è·Œå¹…é™åˆ¶
limit_ratio = {
    'MAIN': 0.10,    # ä¸»æ¿Â±10%
    'GEM': 0.20,     # åˆ›ä¸šæ¿/ç§‘åˆ›æ¿Â±20%
    'STAR': 0.20,
    'BJ': 0.30       # åŒ—äº¤æ‰€Â±30%
}

# æ¶¨åœåˆ¤å®šé€»è¾‘
is_limit_up = (close >= pre_close * (1 + limit_ratio - 0.001))  # å…è®¸0.1%è¯¯å·®

# ä¸€å­—æ¿åˆ¤å®š
is_yizi = (open == close == high == low == limit_price)

# ç‚¸æ¿åˆ¤å®š
is_fried = (high >= limit_price) and (close < limit_price)
â€‹
3.2 è¿æ¿é«˜åº¦è®¡ç®—ç®—æ³•
æ ¸å¿ƒéš¾ç‚¹ï¼šéœ€éå†æ¯åªè‚¡ç¥¨çš„æ—¶é—´åºåˆ—ï¼Œç´¯åŠ è¿ç»­æ¶¨åœå¤©æ•°

ä¼ªä»£ç ï¼š
FOR EACH stock:
    chain_height = 0
    FOR EACH date IN sorted_dates:
        IF today_is_limit_up:
            chain_height += 1
        ELSE:
            chain_height = 0  # æ–­é“¾
        
        SAVE (date, code, chain_height)
â€‹
å››ã€å½“å‰å­˜åœ¨çš„é—®é¢˜
4.1 å¯èƒ½çš„å¡ç‚¹
 æ•°æ®é‡è¿‡å¤§ï¼š5000+è‚¡ç¥¨ Ã— 1500+äº¤æ˜“æ—¥ = 750ä¸‡+æ¡è®°å½•ï¼Œå…¨é‡è®¡ç®—è€—æ—¶
 å†å²æ•°æ®è·å–æ…¢ï¼šAkShareé™æµï¼Œå…¨é‡çˆ¬å–å¯èƒ½éœ€2-4å°æ—¶
 å¤æƒé—®é¢˜ï¼šå†å²æ¶¨åœä»·å› é™¤æƒé™¤æ¯ä¼šå¤±çœŸï¼ˆéœ€å‰å¤æƒï¼Ÿï¼‰
 STè‚¡ç¥¨ç‰¹æ®Šè§„åˆ™ï¼šSTè‚¡ç¥¨æ¶¨è·Œå¹…Â±5%ï¼Œéœ€ç‰¹æ®Šå¤„ç†
 è¿æ¿å®šä¹‰æ¨¡ç³Šï¼šéš”æ—¥æ¶¨åœç®—ä¸ç®—è¿æ¿ï¼Ÿï¼ˆå»ºè®®ï¼šå¿…é¡»è¿ç»­ï¼‰
4.2 æ€§èƒ½ä¼˜åŒ–å»ºè®®
ä½¿ç”¨å‘é‡åŒ–è®¡ç®—ï¼ˆPandas/NumPyï¼‰é¿å…å¾ªç¯
æ•°æ®åº“å»ºç«‹ç´¢å¼•ï¼ˆdate, codeï¼‰
å¢é‡æ›´æ–°è€Œéå…¨é‡é‡ç®—
äº”ã€å»ºè®®çš„å®æ–½è·¯å¾„
Phase 1: MVPæœ€å°å¯è¡Œç‰ˆæœ¬
1. åˆå§‹åŒ–æ•°æ®åº“ + çˆ¬å–æœ€è¿‘3ä¸ªæœˆæ•°æ®ï¼ˆå¿«é€ŸéªŒè¯ï¼‰
2. å®ç°å•è‚¡ç¥¨è¿æ¿é«˜åº¦è®¡ç®—ï¼ˆå…ˆè·‘é€šé€»è¾‘ï¼‰
3. æ‰©å±•åˆ°å…¨å¸‚åœºæ‰¹é‡è®¡ç®—
4. éªŒè¯ç»“æœå‡†ç¡®æ€§ï¼ˆæ‰‹åŠ¨å¯¹æ¯”å‡ åªå¦–è‚¡ï¼‰
â€‹
Phase 2: å®Œæ•´ç‰ˆ
5. çˆ¬å–2020å¹´è‡³ä»Šå…¨é‡å†å²æ•°æ®
6. æ·»åŠ æ•°æ®æ¸…æ´—ä¸å¼‚å¸¸å¤„ç†
7. å®ç°è‡ªåŠ¨å¢é‡æ›´æ–°ï¼ˆæ¯æ—¥æ”¶ç›˜åï¼‰
8. å¼€å‘æŸ¥è¯¢æ¥å£æˆ–å¯è§†åŒ–ç•Œé¢
â€‹
å…­ã€å¿«é€Ÿå¯åŠ¨æŒ‡ä»¤ï¼ˆç»™æ–°AIï¼‰
å¯¹æ–°AIçš„ç¬¬ä¸€å¥è¯å»ºè®®ï¼š
æˆ‘æƒ³å¼€å‘ä¸€ä¸ªAè‚¡è¿æ¿é«˜åº¦è¿½è¸ªç³»ç»Ÿã€‚æ ¸å¿ƒåŠŸèƒ½æ˜¯ï¼š
1. è®¡ç®—æ¯åªè‚¡ç¥¨æ¯å¤©çš„è¿ç»­æ¶¨åœæ¿æ•°ï¼ˆè¿æ¿é«˜åº¦ï¼‰
2. è¯†åˆ«ä¸€å­—æ¿ã€ç‚¸æ¿ã€æ¶¨åœç±»å‹
3. æ”¯æŒå†å²æ•°æ®æŸ¥è¯¢ï¼ˆ2020å¹´è‡³ä»Šï¼‰

æŠ€æœ¯æ ˆå·²é€‰å®šï¼šPython + AkShare + SQLite

è¯·å…ˆå¸®æˆ‘å®ç°ã€è¿æ¿é«˜åº¦è®¡ç®—çš„æ ¸å¿ƒç®—æ³•ã€‘ï¼Œè¦æ±‚ï¼š
- è¾“å…¥ï¼šæŸåªè‚¡ç¥¨çš„æ—¥çº¿æ•°æ®ï¼ˆDataFrameæ ¼å¼ï¼‰
- è¾“å‡ºï¼šæ¯å¤©çš„è¿æ¿é«˜åº¦
- è€ƒè™‘STè‚¡ç¥¨ã€åœç‰Œã€é™¤æƒç­‰ç‰¹æ®Šæƒ…å†µ

ç»™å‡ºå®Œæ•´å¯è¿è¡Œçš„Pythonä»£ç ã€‚
â€‹
ä¸ƒã€å‚è€ƒèµ„æ–™
7.1 å…³é”®æ¦‚å¿µ
è¿æ¿ï¼šè¿ç»­æ¶¨åœæ¿ï¼ˆå¦‚5å¤©5æ¿ = "5è¿æ¿"ï¼‰
é¦–æ¿ï¼šå½“æ—¥é¦–æ¬¡æ¶¨åœï¼ˆchain_height = 1ï¼‰
æ–­æ¿ï¼šè¿æ¿é“¾æ¡ä¸­æ–­ï¼ˆå½“æ—¥æœªæ¶¨åœï¼‰
ä¸€å­—æ¿ï¼šå…¨å¤©å°æ­»æ¶¨åœï¼Œå¼€=é«˜=ä½=æ”¶
ç‚¸æ¿ï¼šç›˜ä¸­è§¦åŠæ¶¨åœä½†æ”¶ç›˜æœªå°ä½
7.2 æ•°æ®ç¤ºä¾‹
æŸè‚¡ç¥¨è¿æ¿è¿‡ç¨‹ï¼š
2024-01-02: æ¶¨åœ â†’ 1æ¿ï¼ˆé¦–æ¿ï¼‰
2024-01-03: æ¶¨åœ â†’ 2æ¿
2024-01-04: æ¶¨åœ â†’ 3æ¿
2024-01-05: è·Œåœ â†’ 0æ¿ï¼ˆæ–­é“¾ï¼‰
2024-01-06: æ¶¨åœ â†’ 1æ¿ï¼ˆæ–°é¦–æ¿ï¼‰
â€‹
å…«ã€é¢„æœŸæˆæœ
å®Œæˆååº”è¯¥èƒ½æ‰§è¡Œä»¥ä¸‹æŸ¥è¯¢ï¼š

-- æŸ¥è¯¢2024å¹´1æœˆ1æ—¥æ‰€æœ‰3æ¿ä»¥ä¸Šçš„è‚¡ç¥¨
SELECT code, name, chain_height 
FROM limit_analysis_result 
WHERE date = '2024-01-01' AND chain_height >= 3
ORDER BY chain_height DESC;

-- ç»Ÿè®¡æŸè‚¡ç¥¨å†å²æœ€é«˜è¿æ¿è®°å½•
SELECT MAX(chain_height) as max_chain
FROM limit_analysis_result
WHERE code = '300059';  -- ä¸œæ–¹è´¢å¯Œ
â€‹
